webpackJsonp([11],{"/Rmg":function(e,t){},"QP/A":function(e,t,o){o("XqYu"),o("lk/p")},"lk/p":function(e,t){},qyUT:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("Fd2+"),r=(o("wvM5"),o("QP/A"),o("cnGM"),o("FDxC"),o("jgNZ"),o("dKGA"),o("GKy3"),o("4T1P"),o("TIfe")),i=o("wDsp"),a={name:"mobile_login",components:{Row:s.w,Col:s.g,CellGroup:s.d,Cell:s.c,Field:s.l,Button:s.b,Toast:s.A,Notify:s.q},props:{},data:function(){return{username:"",password:"",verificationCode:"",loginDisable:!1}},watch:{},computed:{},methods:{inputFocusFn:function(e){this.$refs[e+"Border"].classList.add("focus")},inputBlurFn:function(e){this.$refs[e+"Border"].classList.remove("focus")},updateCodeFn:function(){for(var e="0123456789abcdefghijklmnopqrstuvwxyz",t="",o=0;o<4;o++)t+=e[parseInt(Math.random()*e.length)];this.$refs.verfication_view_code.innerText=t},handleLoginFn:function(){var e=this;if(this.username.trim())if(this.password.trim())if(this.verificationCode.trim())if(this.verificationCode.trim().toUpperCase()!==this.$refs.verfication_view_code.innerText.toUpperCase())this.$toast.fail("验证码错误！");else{this.loginDisable=!0;var t={username:this.username.trim(),password:this.password.trim()};this.$axios.post(i.a.login,t).then(function(t){if(t.data.token){var o=t.data.token,s=t.data.user,i="",a="";if(!s.authority)return e.$notify({type:"danger",message:"该账号没有权限！",duration:2e3}),e.updateCodeFn(),void(e.loginDisable=!1);Object(r.c)(o),e.$store.commit("setUser",s.username),e.$store.commit("setRole",s.role),e.$store.commit("setDepartmentroom",s.departmentroom?s.departmentroom:""),e.$store.commit("setAddress",s.address),e.$store.commit("setAuthority",JSON.parse(s.authority)),e.$store.commit("setRoutes",s.role,s.address);var n={},l={};for(var d in s)"memory"===d.substring(0,6)?n[d]=s[d]:"isShow"===d.substring(0,6)&&(l[d]=s[d]);switch(e.$store.commit("setQueryData",n),e.$store.commit("setChooseData",l),s.address){case"1":i="华西医院",a=e.$store.state.routes[2].children[0].children[0].path;break;default:return}e.$store.commit("setProject",i),e.$router.addRoutes(e.$store.state.routes),e.$notify({type:"success",message:"登录成功！",duration:500}),setTimeout(function(){e.$router.push({path:a})},500)}else t.data.message&&(e.$notify({type:"danger",message:t.data.message,duration:2e3}),e.updateCodeFn(),e.loginDisable=!1)}).catch(function(t){e.$notify({type:"danger",message:"登录错误！",duration:2e3}),e.updateCodeFn(),e.loginDisable=!1})}else this.$toast.fail("请输入验证码！");else this.$toast.fail("请输入密码！");else this.$toast.fail("请输入账号！")}},created:function(){},mounted:function(){this.updateCodeFn()}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"mobile_login_wrap"}},[o("div",{staticClass:"login_logo_box"},[o("Cell",[o("h2",[e._v("医疗资产追踪管理系统")])])],1),e._v(" "),o("div",{staticClass:"login_form_box"},[o("div",{staticClass:"login_form_item"},[o("CellGroup",{attrs:{border:!1}},[o("Field",{attrs:{border:!1,clearable:"",placeholder:"请输入用户名"},on:{focus:function(t){return e.inputFocusFn("userName")},blur:function(t){return e.inputBlurFn("userName")}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),o("div",{staticClass:"input_border_box"},[o("div",{ref:"userNameBorder",staticClass:"input_border_line"})])],1)],1),e._v(" "),o("div",{staticClass:"login_form_item"},[o("CellGroup",{attrs:{border:!1}},[o("Field",{attrs:{border:!1,clearable:"",type:"password",placeholder:"请输入密码"},on:{focus:function(t){return e.inputFocusFn("password")},blur:function(t){return e.inputBlurFn("password")}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),o("div",{staticClass:"input_border_box"},[o("div",{ref:"passwordBorder",staticClass:"input_border_line"})])],1)],1),e._v(" "),o("div",{staticClass:"login_form_item"},[o("CellGroup",{attrs:{border:!1}},[o("Row",[o("Col",{attrs:{span:"16"}},[o("Field",{attrs:{border:!1,clearable:"",placeholder:"请输入验证码"},on:{focus:function(t){return e.inputFocusFn("verificationCode")},blur:function(t){return e.inputBlurFn("verificationCode")}},model:{value:e.verificationCode,callback:function(t){e.verificationCode=t},expression:"verificationCode"}}),e._v(" "),o("div",{staticClass:"input_border_box"},[o("div",{ref:"verificationCodeBorder",staticClass:"input_border_line"})])],1),e._v(" "),o("Col",{attrs:{span:"8"}},[o("div",{staticClass:"verification_code_box"},[o("h3",{ref:"verfication_view_code",attrs:{onselectstart:"return false"},on:{click:e.updateCodeFn}})])])],1)],1)],1),e._v(" "),o("div",{staticClass:"login_form_item"},[o("CellGroup",{attrs:{border:!1}},[o("Cell",{attrs:{border:!1}},[o("Button",{staticClass:"submit_button",attrs:{round:"",disabled:e.loginDisable,color:"#2153a3"},on:{click:e.handleLoginFn}},[e._v("登录")])],1)],1)],1)])])},staticRenderFns:[]};var l=o("VU/8")(a,n,!1,function(e){o("/Rmg")},null,null);t.default=l.exports}});