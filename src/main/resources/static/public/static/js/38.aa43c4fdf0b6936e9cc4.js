webpackJsonp([38],{"52eD":function(e,s){},oit7:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t("Fd2+"),i=(t("jydU"),t("wDsp")),c=t("TIfe"),o={name:"mobile_device_message",components:{Icon:a.m},data:function(){return{deviceMessageArr:[],deviceMessageNum:{lose:0,beyond:0},websock:null}},watch:{mobileScroll:function(){var e=this.mobileScroll;e>54?this.$refs.mobileSearchBoxFixed.classList.add("show"):0===e&&this.$refs.mobileSearchBoxFixed.classList.remove("show")}},computed:{mobileScroll:function(){return this.$store.state.mobileScroll}},methods:{showMoreMenuFn:function(){this.$emit("getMessage",!0)},initWebSocket:function(){this.websock=new WebSocket(i.a.deviceMsgSocket+"/"+Object(c.a)()),this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onmessage=this.websocketonmessage,this.websock.onclose=this.websocketclose},websocketonmessage:function(e){var s=[],t=e.data.split("{");t.splice(0,1),t.forEach(function(e,t){var a=e.split("}");a.splice(a.length-1,1);var i={};a[0].split(",").forEach(function(e,s){var t=e.split("=");i[t[0].trim()]=t[1]}),s.push(i)}),this.deviceMessageArr=s;var a,i=0;this.deviceMessageArr.forEach(function(e,s){e.locDept!==e.department&&e.department&&i++}),a=this.deviceMessageArr.length-i,this.deviceMessageNum.lose=a,this.deviceMessageNum.beyond=i}},activated:function(){this.initWebSocket()},deactivated:function(){this.websock.close()}},n={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"mobile_device_message_wrap"}},[t("div",{staticClass:"mobile_search_wrap"},[t("div",{ref:"mobileSearchBoxFixed",staticClass:"mobile_device_message_header"},[e._m(0),e._v(" "),t("div",{staticClass:"mobile_device_header_tools"},[t("Icon",{attrs:{name:"bars"},on:{click:e.showMoreMenuFn}})],1)])]),e._v(" "),t("div",{staticClass:"device_message_box"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.deviceMessageArr.length,expression:"!deviceMessageArr.length"}],staticClass:"device_message_notice"},[t("span",[e._v("暂无动态...")])]),e._v(" "),t("ul",{directives:[{name:"show",rawName:"v-show",value:e.deviceMessageArr.length,expression:"deviceMessageArr.length"}],staticClass:"device_message_ul"},e._l(e.deviceMessageArr,function(s,a){return t("li",{staticClass:"device_message_item"},[t("div",[t("p",[t("span",[e._v(e._s(a+1))]),e._v(". "),t("span",{class:s.locDept!==s.department&&s.department?"device_message_color_2":"device_message_color_1"},[e._v(e._s("null"===s.assetName?"--":s.assetName))]),e._v(" - "),t("span",[e._v(e._s("null"===s.assetID?"--":s.assetID))]),e._v(" "),t("span",{class:s.locDept!==s.department&&s.department?"beyond":"lose"},[e._v(e._s(s.locDept!==s.department&&s.department?"超出电子围栏范围":"丢失信号"))])])]),e._v(" "),t("div",[t("p",[e._v("品牌："),t("b",[e._v(e._s("null"===s.brand?"--":s.brand))]),e._v(" & 型号："),t("b",[e._v(e._s("null"===s.type?"--":s.type))])]),e._v(" "),t("p",[e._v("最近更新时间："),t("b",[e._v(e._s("null"===s.updatetime?"--":s.updatetime))]),e._v(" & 房间名："),t("b",[e._v(e._s("null"===s.cadMapRoomName?"--":s.cadMapRoomName))])]),e._v(" "),t("p",[e._v("所属科室："),t("b",[e._v(e._s("null"===s.locDept?"--":s.locDept))]),e._v(" & 实时所在科室："),t("b",[e._v(e._s("null"===s.department?"--":s.department))])])])])}),0)]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.deviceMessageArr.length,expression:"deviceMessageArr.length"}],staticClass:"device_message_num_box custom_flex_row_wrap"},[t("div",{staticClass:"device_message_num_item"},[t("span",[e._v(e._s(e.deviceMessageNum.lose)+"件")])]),e._v(" "),t("div",{staticClass:"device_message_num_item"},[t("span",[e._v(e._s(e.deviceMessageNum.beyond)+"件")])])])])},staticRenderFns:[function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"mobile_device_message_title"},[s("p",[this._v("设备动态")])])}]};var r=t("VU/8")(o,n,!1,function(e){t("52eD")},"data-v-3ba1c2f4",null);s.default=r.exports}});