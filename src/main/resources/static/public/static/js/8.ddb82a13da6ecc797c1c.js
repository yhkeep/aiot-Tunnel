webpackJsonp([8],{"9Cmf":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("EMb8"),i=a("NHTL"),n=a("yoLw"),o=a("7+uW"),r=a("Gaqz"),l=a("WBHA"),c=a.n(l),u=a("gUqX"),d=a("gyyF"),m=a("eJLk"),_=a("DAxA"),h=a("wDsp"),p=a("TIfe");o.a.component("Table",n.a),o.a.component("Tag",i.a),o.a.component("Icon",s.a);var v={name:"home",components:{countTo:c.a},props:{},data:function(){return{statusColor:m.a,user:this.$store.state.user,deviceMessageArr:[],deviceMessageNum:{lose:0,beyond:0},websock:null,tableLoading:!0,summaryList:[{value:0,text:"资产总额",unit:"元",color:"#2d8cf0",icon:"md-cube"},{value:0,text:"资产总量",unit:"件",color:"#19be6b",icon:"ios-pie"},{value:0,text:"维修接单",unit:"件",color:"#f3a32a",icon:"md-hammer"},{value:0,text:"总盘点数",unit:"件",color:"#9a66e4",icon:"ios-contrast"}],newAssetsColumn:[{title:"资产编号",key:"assetID"},{title:"通用名称",key:"generalName"},{title:"资产名称",key:"assetName"},{title:"规格",key:"specification"},{title:"型号",key:"type"},{title:"存放地点",key:"location"},{title:"产地",key:"placeoforigin"},{title:"品牌",key:"brand"},{title:"部门编码",key:"departmentcode"},{title:"部门名称",key:"departmentroom"},{title:"大科室编码",key:"homeofficenumber"},{title:"大科室名称",key:"homeofficename"},{title:"所在科室名称",key:"locDept"},{title:"SN",key:"sn"},{title:"状态",key:"status",slot:"status",width:120}],assetsConfigArr:_.a,newAssetsData:[],damageChart:null,checkChart:null,damageData:[0,0,0,0,0,0],checkData:[0,0,0]}},watch:{isCollapsed:function(){var t=this;setTimeout(function(){t.damageChart.resize(),t.checkChart.resize()},500)}},computed:{isCollapsed:function(){return this.$store.state.isCollapsed}},methods:{transWebsocketFn:function(t){var e=[],a=t.split("{");return a.splice(0,1),a.forEach(function(t,a){var s=t.split("}");s.splice(s.length-1,1);var i={};s[0].split(",").forEach(function(t,e){var a=t.split("=");i[a[0].trim()]=a[1]}),e.push(i)}),e},initWebSocket:function(){this.websock=new WebSocket(h.a.deviceMsgSocket+"/"+Object(p.a)()),this.websock.onmessage=this.websocketonmessage},websocketonmessage:function(t){this.deviceMessageArr=this.transWebsocketFn(t.data);var e,a=0;this.deviceMessageArr.forEach(function(t,e){t.locDept!==t.department&&t.department&&a++}),e=this.deviceMessageArr.length-a,this.deviceMessageNum.lose=e,this.deviceMessageNum.beyond=a},setAllOldFn:function(){this.damageChart=echarts.init(document.getElementById("damage_ratio_wrap"));var t=this.damageData[0]+this.damageData[1]+this.damageData[2]+this.damageData[3]+this.damageData[4]+this.damageData[5],e=parseFloat(Number(this.damageData[0]/t*100).toFixed(1)),a=parseFloat(Number(this.damageData[1]/t*100).toFixed(1)),s=parseFloat(Number(this.damageData[2]/t*100).toFixed(1)),i=parseFloat(Number(this.damageData[3]/t*100).toFixed(1)),n=parseFloat(Number(this.damageData[4]/t*100).toFixed(1)),o=parseFloat((100-(e+a+s+i+n)).toFixed(1));u.a.series[0].data=[{value:e,name:"正常"},{value:a,name:"待维修"},{value:s,name:"维修接单"},{value:i,name:"待报废"},{value:n,name:"报废"},{value:o,name:"外借"}],this.damageChart.setOption(u.a)},setCheckFn:function(){this.checkChart=echarts.init(document.getElementById("check_pie_wrap"));var t=this.checkData[0]+this.checkData[1],e=parseFloat(Number(this.checkData[0]/t*100).toFixed(1)),a=parseFloat((100-e).toFixed(1));d.a.series[0].data=[{value:e,name:"今日已盘"},{value:a,name:"今日未盘"}],this.checkChart.setOption(d.a)},getDataFn:function(){var t=this;this.$Loading.start(),this.$axios.post(h.a.assetsQuery).then(function(e){for(var a=e.data,s=(Number(a.pop().total),function(e){var s=[];for(var i in a[e])""!==a[e][i]&&"null"!==a[e][i]||(a[e][i]="--"),s.push(i);t.assetsConfigArr.forEach(function(t,i){s.find(function(e,a){return e===t})||(a[e][t]="--")})}),i=0;i<a.length;i++)s(i);t.newAssetsData=a,t.$Loading.finish(),t.tableLoading=!1}).catch(function(e){t.$Loading.error()});this.user;this.$axios.post(h.a.assetsTotalNum).then(function(e){var a=e.data[0];"failed"===a.msg||(t.summaryList.forEach(function(t,e){switch(t.text){case"资产总额":t.value=a.aggregate;break;case"资产总量":t.value=a.examined+a.unexamined;break;case"维修接单":t.value=a.maintain;break;case"总盘点数":t.value=a.totalCheck?a.totalCheck:0;break;default:return}}),t.damageData=[a.normal?a.normal:0,a.tobescrap?a.tobescrap:0,a.maintain?a.maintain:0,a.scrap?a.scrap:0,a.hasScrap?a.hasScrap:0,a.lend?a.lend:0],t.checkData=[a.examined,a.unexamined,a.totalCheck],t.setAllOldFn(),t.setCheckFn())}).catch(function(t){})},afterResizeFn:function(){this.damageChart.resize(),this.checkChart.resize()}},created:function(){this.initWebSocket()},mounted:function(){var t=this;this.$nextTick(function(){Object(r.a)().then(function(){t.getDataFn(),window.addEventListener("resize",t.afterResizeFn,!0)})})},beforeDestroy:function(){this.websock.close(),window.removeEventListener("resize",this.afterResizeFn,!0)}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home_wrap"},[a("div",{staticClass:"custom_flex_wrap total_data_wrap"},t._l(t.summaryList,function(e,s){return a("div",{key:s,staticClass:"total_data_item custom_flex_item_4 custom_bg_color_white hover_animat"},[a("div",{staticClass:"total_icon_box",style:"background-color:"+e.color},[a("Icon",{attrs:{type:e.icon}})],1),t._v(" "),a("div",{staticClass:"total_item_box"},[a("div",{staticClass:"total_item_box_top"},[a("countTo",{attrs:{startVal:0,endVal:Number(e.value),separator:"",duration:1e3,decimals:e.value.toString().indexOf(".")>-1?e.value.toString().length-(e.value.toString().indexOf(".")+1):0,suffix:e.unit}})],1),t._v(" "),a("div",{staticClass:"total_item_box_bottom"},[t._v("\n                      "+t._s(e.text)+"\n                  ")])])])}),0),t._v(" "),a("div",{staticClass:"custom_flex_wrap row_wrap"},[a("div",{staticClass:"custom_flex_item_3_no hover_animat custom_bg_color_white row_box"},[a("h2",{staticClass:"row_title"},[t._v("设备动态")]),t._v(" "),a("div",{staticClass:"device_message_box",staticStyle:{"margin-bottom":"10px"}},[t.deviceMessageArr.length<=0?a("h3",[t._v("暂无动态...")]):a("div",{staticClass:"device_message_scroll_wrap"},[a("div",{staticClass:"device_message_scroll_box"},t._l(t.deviceMessageArr,function(e,s){return a("div",{key:s,staticClass:"device_message_item"},[a("div",{staticClass:"device_message_item_left"},[a("div",{class:e.locDept!==e.department&&e.department?"device_message_icon_box device_message_bg_color_2":"device_message_icon_box device_message_bg_color_1"},[a("Icon",{attrs:{type:"ios-warning"}})],1)]),t._v(" "),a("div",{staticClass:"device_message_item_right"},[a("div",{staticClass:"device_message_item_right_top"},[a("span",[t._v(t._s(s+1))]),t._v(". "),a("b",{class:e.locDept!==e.department&&e.department?"device_message_color_2":"device_message_color_1"},[t._v(t._s("null"===e.assetName?"":e.assetName))]),t._v(" - "),a("span",[t._v(t._s("null"===e.assetID?"":e.assetID))]),a("span",{class:e.locDept!==e.department&&e.department?"beyond":"lose"},[t._v(t._s(e.locDept!==e.department&&e.department?"超出电子围栏范围":"丢失信号"))])]),t._v(" "),a("div",{staticClass:"device_message_item_right_bottom"},[a("p",[t._v("品牌："),a("b",[t._v(t._s("null"===e.brand?"":e.brand))]),t._v(" & 型号："),a("b",[t._v(t._s("null"===e.type?"":e.type))])]),t._v(" "),a("p",[t._v("最近更新时间："),a("b",[t._v(t._s("null"===e.updatetime?"":e.updatetime))]),t._v(" & 房间名："),a("b",[t._v(t._s("null"===e.cadMapRoomName?"":e.cadMapRoomName))])]),t._v(" "),a("p",[t._v("所属科室："),a("b",[t._v(t._s("null"===e.locDept?"":e.locDept))]),t._v(" & 实时所在科室："),a("b",[t._v(t._s("null"===e.department?"":e.department))])])])])])}),0)])]),t._v(" "),a("div",{staticClass:"custom_flex_wrap"},[a("div",{staticClass:"device_message_num_item"},[a("span",[t._v(t._s(t.deviceMessageNum.lose)+"件")])]),t._v(" "),a("div",{staticClass:"device_message_num_item"},[a("span",[t._v(t._s(t.deviceMessageNum.beyond)+"件")])])])]),t._v(" "),a("div",{staticClass:"custom_flex_item_3_no hover_animat custom_bg_color_white row_box"},[a("h2",{staticClass:"row_title"},[t._v("维修报废")]),t._v(" "),a("div",{staticClass:"data_block",staticStyle:{"margin-bottom":"10px"},attrs:{id:"damage_ratio_wrap"}}),t._v(" "),a("div",{staticClass:"custom_flex_wrap"},[a("div",{staticClass:"damage_num_item"},[a("span",[t._v(t._s(t.damageData[0])+"件")])]),t._v(" "),a("div",{staticClass:"damage_num_item"},[a("span",[t._v(t._s(t.damageData[1])+"件")])]),t._v(" "),a("div",{staticClass:"damage_num_item"},[a("span",[t._v(t._s(t.damageData[2])+"件")])]),t._v(" "),a("div",{staticClass:"damage_num_item"},[a("span",[t._v(t._s(t.damageData[3])+"件")])]),t._v(" "),a("div",{staticClass:"damage_num_item"},[a("span",[t._v(t._s(t.damageData[4])+"件")])]),t._v(" "),a("div",{staticClass:"damage_num_item"},[a("span",[t._v(t._s(t.damageData[5])+"件")])])])]),t._v(" "),a("div",{staticClass:"custom_flex_item_3_no hover_animat custom_bg_color_white row_box"},[a("h2",{staticClass:"row_title"},[t._v("今日盘点")]),t._v(" "),a("div",{staticClass:"data_block",staticStyle:{"margin-bottom":"10px"},attrs:{id:"check_pie_wrap"}}),t._v(" "),a("div",{staticClass:"custom_flex_wrap"},[a("div",{staticClass:"check_num_item"},[a("span",[t._v(t._s(t.checkData[0])+"件")])]),t._v(" "),a("div",{staticClass:"check_num_item"},[a("span",[t._v(t._s(t.checkData[1])+"件")])])])])]),t._v(" "),a("div",{staticClass:"row_wrap hover_animat custom_bg_color_white"},[a("div",{staticClass:"row_box"},[a("h2",{staticClass:"row_title"},[t._v("最近新增资产")]),t._v(" "),a("div",{staticClass:"table_scroll_wrap"},[a("Table",{staticStyle:{"min-width":"1500px"},attrs:{stripe:"",columns:t.newAssetsColumn,data:t.newAssetsData,size:"large",loading:t.tableLoading},scopedSlots:t._u([{key:"status",fn:function(e){var s=e.row;return["正常"===s.status?a("Tag",{attrs:{color:t.statusColor[0]}},[a("span",[t._v(t._s(s.status))])]):"待维修"===s.status?a("Tag",{attrs:{color:t.statusColor[1]}},[a("span",[t._v(t._s(s.status))])]):"维修接单"===s.status?a("Tag",{attrs:{color:t.statusColor[2]}},[a("span",[t._v(t._s(s.status))])]):"待报废"===s.status?a("Tag",{attrs:{color:t.statusColor[3]}},[a("span",[t._v(t._s(s.status))])]):"报废"===s.status?a("Tag",{attrs:{color:t.statusColor[4]}},[a("span",[t._v(t._s(s.status))])]):"外借"===s.status?a("Tag",{attrs:{color:t.statusColor[5]}},[a("span",[t._v(t._s(s.status))])]):a("Tag",{attrs:{color:"default"}},[a("span",[t._v(t._s(s.status))])])]}}])})],1)])])])},staticRenderFns:[]};var g=a("VU/8")(v,f,!1,function(t){a("wMNX")},"data-v-73e13ed6",null);e.default=g.exports},WBHA:function(t,e,a){var s;s=function(){return function(t){function e(s){if(a[s])return a[s].exports;var i=a[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var a={};return e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,s){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=2)}([function(t,e,a){var s=a(4)(a(1),a(5),null,null);t.exports=s.exports},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(3);e.default={props:{startVal:{type:Number,required:!1,default:0},endVal:{type:Number,required:!1,default:2017},duration:{type:Number,required:!1,default:3e3},autoplay:{type:Boolean,required:!1,default:!0},decimals:{type:Number,required:!1,default:0,validator:function(t){return t>=0}},decimal:{type:String,required:!1,default:"."},separator:{type:String,required:!1,default:","},prefix:{type:String,required:!1,default:""},suffix:{type:String,required:!1,default:""},useEasing:{type:Boolean,required:!1,default:!0},easingFn:{type:Function,default:function(t,e,a,s){return a*(1-Math.pow(2,-10*t/s))*1024/1023+e}}},data:function(){return{localStartVal:this.startVal,displayValue:this.formatNumber(this.startVal),printVal:null,paused:!1,localDuration:this.duration,startTime:null,timestamp:null,remaining:null,rAF:null}},computed:{countDown:function(){return this.startVal>this.endVal}},watch:{startVal:function(){this.autoplay&&this.start()},endVal:function(){this.autoplay&&this.start()}},mounted:function(){this.autoplay&&this.start(),this.$emit("mountedCallback")},methods:{start:function(){this.localStartVal=this.startVal,this.startTime=null,this.localDuration=this.duration,this.paused=!1,this.rAF=(0,s.requestAnimationFrame)(this.count)},pauseResume:function(){this.paused?(this.resume(),this.paused=!1):(this.pause(),this.paused=!0)},pause:function(){(0,s.cancelAnimationFrame)(this.rAF)},resume:function(){this.startTime=null,this.localDuration=+this.remaining,this.localStartVal=+this.printVal,(0,s.requestAnimationFrame)(this.count)},reset:function(){this.startTime=null,(0,s.cancelAnimationFrame)(this.rAF),this.displayValue=this.formatNumber(this.startVal)},count:function(t){this.startTime||(this.startTime=t),this.timestamp=t;var e=t-this.startTime;this.remaining=this.localDuration-e,this.useEasing?this.countDown?this.printVal=this.localStartVal-this.easingFn(e,0,this.localStartVal-this.endVal,this.localDuration):this.printVal=this.easingFn(e,this.localStartVal,this.endVal-this.localStartVal,this.localDuration):this.countDown?this.printVal=this.localStartVal-(this.localStartVal-this.endVal)*(e/this.localDuration):this.printVal=this.localStartVal+(this.localStartVal-this.startVal)*(e/this.localDuration),this.countDown?this.printVal=this.printVal<this.endVal?this.endVal:this.printVal:this.printVal=this.printVal>this.endVal?this.endVal:this.printVal,this.displayValue=this.formatNumber(this.printVal),e<this.localDuration?this.rAF=(0,s.requestAnimationFrame)(this.count):this.$emit("callback")},isNumber:function(t){return!isNaN(parseFloat(t))},formatNumber:function(t){t=t.toFixed(this.decimals);var e=(t+="").split("."),a=e[0],s=e.length>1?this.decimal+e[1]:"",i=/(\d+)(\d{3})/;if(this.separator&&!this.isNumber(this.separator))for(;i.test(a);)a=a.replace(i,"$1"+this.separator+"$2");return this.prefix+a+s+this.suffix}},destroyed:function(){(0,s.cancelAnimationFrame)(this.rAF)}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){return t&&t.__esModule?t:{default:t}}(a(0));e.default=s.default,"undefined"!=typeof window&&window.Vue&&window.Vue.component("count-to",s.default)},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=0,i="webkit moz ms o".split(" "),n=void 0,o=void 0;if("undefined"==typeof window)e.requestAnimationFrame=n=function(){},e.cancelAnimationFrame=o=function(){};else{e.requestAnimationFrame=n=window.requestAnimationFrame,e.cancelAnimationFrame=o=window.cancelAnimationFrame;for(var r=void 0,l=0;l<i.length&&(!n||!o);l++)r=i[l],e.requestAnimationFrame=n=n||window[r+"RequestAnimationFrame"],e.cancelAnimationFrame=o=o||window[r+"CancelAnimationFrame"]||window[r+"CancelRequestAnimationFrame"];n&&o||(e.requestAnimationFrame=n=function(t){var e=(new Date).getTime(),a=Math.max(0,16-(e-s)),i=window.setTimeout(function(){t(e+a)},a);return s=e+a,i},e.cancelAnimationFrame=o=function(t){window.clearTimeout(t)})}e.requestAnimationFrame=n,e.cancelAnimationFrame=o},function(t,e){t.exports=function(t,e,a,s){var i,n=t=t||{},o=typeof t.default;"object"!==o&&"function"!==o||(i=t,n=t.default);var r="function"==typeof n?n.options:n;if(e&&(r.render=e.render,r.staticRenderFns=e.staticRenderFns),a&&(r._scopeId=a),s){var l=Object.create(r.computed||null);Object.keys(s).forEach(function(t){var e=s[t];l[t]=function(){return e}}),r.computed=l}return{esModule:i,exports:n,options:r}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",[t._v("\n  "+t._s(t.displayValue)+"\n")])},staticRenderFns:[]}}])},t.exports=s()},gUqX:function(t,e,a){"use strict";e.a={color:["#19be6b","#ddbd2b","#ff9900","#e46cbb","#ed4014","#9a66e4"],legend:{show:!0,data:["正常","待维修","维修接单","待报废","报废","外借"]},series:[{name:"资产状态",type:"pie",radius:"50%",center:["50%","60%"],label:{normal:{formatter:"{c}%",textStyle:{fontSize:14}}},labelLine:{normal:{length:5,lineStyle:{}}},data:[{value:90,name:"正常"},{value:3,name:"待维修"},{value:1,name:"维修接单"},{value:2,name:"待报废"},{value:1,name:"报废"},{value:3,name:"外借"}]}]}},gyyF:function(t,e,a){"use strict";e.a={color:["#009688","#ddbd2b"],legend:{show:!0,data:["今日已盘","今日未盘"]},series:[{name:"资产盘点情况",type:"pie",radius:"50%",center:["50%","60%"],label:{normal:{formatter:"{c}%",textStyle:{fontSize:14}}},labelLine:{normal:{length:5,lineStyle:{}}},data:[{value:60,name:"今日已盘"},{value:40,name:"今日未盘"}]}]}},wMNX:function(t,e){}});