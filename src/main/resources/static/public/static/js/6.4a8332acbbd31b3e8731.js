webpackJsonp([6],{"6d7H":function(t,s){},I40i:function(t,s){},Medb:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a("Fd2+"),i=(a("FDxC"),a("2PSJ"),a("d9cu"),a("OeKT"),a("MHRi"),a("GKy3"),a("uTM9"),a("UEU1"),a("wvM5"),a("tLo2"),a("9ULi"),a("jydU"),a("4T1P"),a("wDsp")),c=a("TIfe"),o=(a("q29v"),a("eJLk")),l={name:"mobile_check_manage",components:{Button:e.b,Tag:e.z,CheckboxGroup:e.f,Checkbox:e.e,Dialog:e.i,Toast:e.A,Loading:e.m,Pagination:e.p,Field:e.j,Popup:e.r,Search:e.u,Icon:e.k,Notify:e.o},props:{},data:function(){return{statusColor:o.a,user:this.$store.state.user,currentPage:1,totalCount:0,hasMore:!0,checked:!0,assetsDetailData:[],deviceDetailData:[],checkedArr:[],checkAll:!1,loadingShow:!0,showPagination:!1,queryData:{assetID:"",assetName:"",mac:""},websock:null,value:"",showSearchPane:!1}},watch:{deviceDetailData:function(){var t=this;this.deviceDetailData.forEach(function(s,a){t.assetsDetailData.forEach(function(t,a){s.Mac===t.mac&&(t.location=s.Location)})})},checkedArr:function(){this.checkedArr.length&&this.checkedArr.length===this.assetsDetailData.length?this.checkAll=!0:this.checkAll=!1}},computed:{assetsDetailDataNow:function(){return this.assetsDetailData}},methods:{toCheckHistoryFn:function(){this.$router.push("/mobile/check_history")},openSearchPaneFn:function(){this.showSearchPane=!0},searchFn:function(){this.currentPage=1,this.assetsDetailData=[],this.checkedArr=[],this.checkAll=!1,this.totalCount=0,this.getDataFn(),this.showSearchPane=!1},checkAllFn:function(){!1===this.checkAll?this.$refs.checkboxGroup.toggleAll(!0):this.$refs.checkboxGroup.toggleAll(!1)},checkFn:function(){var t=this,s=[];this.checkedArr.forEach(function(a,e){t.assetsDetailData.forEach(function(t,e){a===t.assetID&&s.push(t)})}),s.length?s.length>1?e.i.confirm({title:"盘点提示！",message:"你确定要同时盘点这"+s.length+"个资产吗？"}).then(function(){t.checkCertainFn(s)}).catch(function(){}):this.checkCertainFn(s):this.$notify({type:"warning",message:"请至少选择一个资产！",duration:2e3})},checkCertainFn:function(t){var s=this,a=[];t.forEach(function(t,s){var e={assetID:t.assetID.trim()};a.push(e)});var e=this.$toast.loading({message:"盘点中...",forbidClick:!0,duration:0});this.$axios.post(i.a.assetsCheck+"checkpep="+this.user,a).then(function(t){"success"===t.data.msg?(e.clear(),s.$toast.success("盘点成功！"),s.assetsDetailData=[],s.checkedArr=[],s.checkAll=!1,s.totalCount=0,s.getDataFn()):(e.clear(),s.$toast.fail("盘点失败！"))}).catch(function(t){e.clear()})},getDataFn:function(){var t=this;this.loadingShow=!0,this.assetsDetailData=[],this.$axios.post(i.a.assetsQuery+"?currentPage="+this.currentPage+"&assetName="+this.queryData.assetName.trim()+"&assetID="+this.queryData.assetID.trim()+"&mac="+this.queryData.mac.trim()).then(function(s){for(var a=s.data,e=Number(a.pop().total),i=0;i<a.length;i++){for(var c in a[i])""!==a[i][c]&&"null"!==a[i][c]||(a[i][c]="--");t.assetsDetailData.push(a[i])}t.totalCount=e,t.loadingShow=!1,t.showPagination=!0}).catch(function(t){})},getMoreFn:function(){this.currentPage+=1,this.getDataFn()},changePageFn:function(){this.checkedArr=[],this.checkAll=!1,this.getDataFn()},transWebsocketFn:function(t){var s=[],a=t.split("{");return a.splice(0,1),a.forEach(function(t,a){var e=t.split("}");e.splice(e.length-1,1);var i={};e[0].split(",").forEach(function(t,s){var a=t.split("=");i[a[0].trim()]=a[1]}),s.push(i)}),s},initWebSocket:function(){this.websock=new WebSocket(i.a.mapSocket+"/"+Object(c.a)()),this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onmessage=this.websocketonmessage,this.websock.onclose=this.websocketclose},websocketonmessage:function(t){var s=this.transWebsocketFn(t.data);this.deviceDetailData=s}},created:function(){},mounted:function(){this.getDataFn(),this.initWebSocket()},beforeDestroy:function(){this.websock.close()}},n={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"mobile_check_manage_wrap manage_list_wrap custom_flex_column_wrap"},[a("Search",{attrs:{disabled:"",placeholder:"点击展开搜索面板","show-action":"",shape:"round"},on:{click:t.openSearchPaneFn},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{staticClass:"clearfix",staticStyle:{"vertical-align":"center","line-height":"24px",width:"110px","text-align":"center"}},[a("div",{staticStyle:{float:"left",width:"70px"}},[a("Button",{staticStyle:{"margin-top":"1px"},attrs:{size:"small",round:"",type:"primary"},on:{click:t.checkFn}},[t._v("盘点")])],1),t._v(" "),a("div",{staticStyle:{float:"left",width:"40px"}},[a("Icon",{staticStyle:{"margin-top":"5px"},attrs:{name:"clock-o"},on:{click:t.toCheckHistoryFn}})],1)])]},proxy:!0}]),model:{value:t.value,callback:function(s){t.value=s},expression:"value"}}),t._v(" "),a("div",{staticClass:"assets_table_wrap"},[a("div",{staticClass:"assets_table_wrap_content  clearfix"},[a("div",{staticClass:"assets_table_wrap_left"},[a("ul",{staticClass:"assets_table_ul"},[a("li",{staticClass:"assets_table_li assets_table_li_name"},[a("div",{staticClass:"assets_table_li_checkbox"},[a("Checkbox",{attrs:{shape:"square","checked-color":"#07c160"},on:{click:t.checkAllFn},model:{value:t.checkAll,callback:function(s){t.checkAll=s},expression:"checkAll"}})],1)]),t._v(" "),a("CheckboxGroup",{ref:"checkboxGroup",model:{value:t.checkedArr,callback:function(s){t.checkedArr=s},expression:"checkedArr"}},t._l(t.assetsDetailData,function(t,s){return a("li",{key:s,staticClass:"assets_table_li"},[a("div",{staticClass:"assets_table_li_checkbox"},[a("Checkbox",{attrs:{name:t.assetID,shape:"square","checked-color":"#07c160"},on:{click:function(t){t.stopPropagation()}}})],1)])}),0)],1)]),t._v(" "),a("div",{staticClass:"assets_table_wrap_right"},[a("ul",{staticClass:"assets_table_ul"},[t._m(0),t._v(" "),t._l(t.assetsDetailData,function(s,e){return a("li",{key:e,staticClass:"assets_table_li clearfix"},[a("div",{staticClass:"assets_table_item"},[t._v(t._s(e+1))]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v(t._s(s.assetID?s.assetID:"--"))]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v(t._s(s.assetName?s.assetName:"--"))]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v(t._s(s.locDept?s.locDept:"--"))]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v(t._s(s.location?s.location:"--"))]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v(t._s(s.mac?s.mac:"--"))]),t._v(" "),a("div",{staticClass:"assets_table_item"},["正常"===s.status?a("Tag",{attrs:{size:"medium",color:t.statusColor[0]}},[t._v(t._s(s.status))]):"待维修"===s.status?a("Tag",{attrs:{size:"medium",color:t.statusColor[1]}},[t._v(t._s(s.status))]):"维修接单"===s.status?a("Tag",{attrs:{size:"medium",color:t.statusColor[2]}},[t._v(t._s(s.status))]):"待报废"===s.status?a("Tag",{attrs:{size:"medium",color:t.statusColor[3]}},[t._v(t._s(s.status))]):"报废"===s.status?a("Tag",{attrs:{size:"medium",color:t.statusColor[4]}},[t._v(t._s(s.status))]):"外借"===s.status?a("Tag",{attrs:{size:"medium",color:t.statusColor[5]}},[t._v(t._s(s.status))]):a("Tag",{attrs:{size:"medium",color:"#f7f7f7","text-color":"#515a6e"}},[t._v(t._s(s.status))])],1),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v(t._s(s.sn?s.sn:"--"))])])})],2)])]),t._v(" "),a("div",{staticClass:"loading_info_wrap"},[a("Pagination",{directives:[{name:"show",rawName:"v-show",value:t.showPagination&&t.assetsDetailData.length,expression:"showPagination&&assetsDetailData.length"}],attrs:{"total-items":t.totalCount,"show-page-size":2,"prev-text":"上一页","next-text":"下一页","force-ellipses":"",mode:"simple"},on:{change:t.changePageFn},model:{value:t.currentPage,callback:function(s){t.currentPage=s},expression:"currentPage"}}),t._v(" "),a("Loading",{directives:[{name:"show",rawName:"v-show",value:t.loadingShow,expression:"loadingShow"}],attrs:{size:"24px"}},[t._v("加载中...")])],1)]),t._v(" "),a("Popup",{attrs:{position:"top"},model:{value:t.showSearchPane,callback:function(s){t.showSearchPane=s},expression:"showSearchPane"}},[a("div",{staticClass:"query_data_wrap"},[a("Field",{attrs:{clearable:"",label:"资产编号",placeholder:"请输入要查询的资产编号"},model:{value:t.queryData.assetID,callback:function(s){t.$set(t.queryData,"assetID",s)},expression:"queryData.assetID"}}),t._v(" "),a("Field",{attrs:{clearable:"",label:"资产名称",placeholder:"请输入要查询的资产名称"},model:{value:t.queryData.assetName,callback:function(s){t.$set(t.queryData,"assetName",s)},expression:"queryData.assetName"}}),t._v(" "),a("Field",{attrs:{clearable:"",label:"标签mac",placeholder:"请输入要查询的标签mac"},model:{value:t.queryData.mac,callback:function(s){t.$set(t.queryData,"mac",s)},expression:"queryData.mac"}}),t._v(" "),a("div",{staticClass:"tools_button_wrap"},[a("Button",{staticClass:"tools_button",attrs:{type:"primary",round:""},on:{click:t.searchFn}},[t._v("搜索")])],1)],1)])],1)},staticRenderFns:[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("li",{staticClass:"assets_table_li assets_table_li_name clearfix"},[a("div",{staticClass:"assets_table_item"},[t._v("序号")]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v("资产编号")]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v("资产名称")]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v("科室名称")]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v("存放地点")]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v("标签mac")]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v("状态")]),t._v(" "),a("div",{staticClass:"assets_table_item"},[t._v("SN")])])}]};var r=a("VU/8")(l,n,!1,function(t){a("RIda")},"data-v-7eb46bbe",null);s.default=r.exports},OeKT:function(t,s,a){a("XqYu")},RIda:function(t,s){},UEU1:function(t,s,a){a("XqYu"),a("I40i")},d9cu:function(t,s,a){a("XqYu"),a("s1Ps"),a("6d7H")}});