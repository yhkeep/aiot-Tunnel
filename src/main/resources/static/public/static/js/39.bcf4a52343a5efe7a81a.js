webpackJsonp([39],{DoYh:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e("mvHQ"),n=e.n(o),s=e("mRcN"),i=e("wdqF"),l=e("bzvv"),c=e("8sRp"),r=e("KxKW"),u=e("JtJ0"),v=e("HYs4"),p=e("NHTL"),f=e("X2sI"),g=e("LuSo"),_=e("yoLw"),m=e("NAz/"),h=e("a84E"),d=e("EMb8"),D=e("7+uW"),w=e("wDsp");D.a.component("Icon",d.a),D.a.component("Row",h.a),D.a.component("Col",m.a),D.a.component("Table",_.a),D.a.component("Select",g.a),D.a.component("Option",f.a),D.a.component("Tag",p.a),D.a.component("Page",v.a),D.a.component("Input",u.a),D.a.component("Button",r.a),D.a.component("Modal",c.a),D.a.component("InputNumber",l.a),D.a.component("Spin",i.a),D.a.component("i-switch",s.a);var b={name:"gateway_setting",components:{},props:{},data:function(){return{whetherData:[{value:"YES",label:"是"},{value:"NO",label:"否"}],qosData:[{value:0,label:"0"},{value:1,label:"1"}],setAllKey:!1,configData:{disableLED:"YES",isLongBright:"NO",isUploadUnkown:"YES",isUploadIBeacon:"YES",isUploadS1:"YES",isUploadGateway:"YES",isauto:"NO",mqttUrl:"172.20.29.2",port:"",qos:1,timeout:30,macReg:"",publishTopic:"",subscribeTopic:"",responseTopic:""},gatewayArr:[],macArr:[]}},watch:{},computed:{},methods:{switchChangeFn:function(a){this.macArr=[]},macDeleteFn:function(a,t){var e=this;this.selectMacArr.forEach(function(a,o){a===t&&e.selectMacArr.splice(o,1)})},saveConfigFn:function(){var a=this;this.setAllKey||this.macArr.length?this.$Modal.confirm({title:"保存提示",okText:"确定",cancelText:"取消",content:'<h2 style="color:#f94040">你确定要保存当前配置吗？离线状态的网关将无法保存配置</h2>',onOk:function(){var t=[],e={gatewaymac:"",disableLED:a.configData.disableLED,isLongBright:a.configData.isLongBright,isUploadUnkown:a.configData.isUploadUnkown,isUploadIBeacon:a.configData.isUploadIBeacon,isUploadS1:a.configData.isUploadS1,isUploadGateway:a.configData.isUploadGateway,isauto:a.configData.isauto,mqttUrl:a.configData.mqttUrl.trim(),port:a.configData.port.trim(),qos:a.configData.qos.toString(),timeout:a.configData.timeout.toString(),macReg:a.filterMacRegFn(a.configData.macReg.trim())};a.setAllKey?a.gatewayArr.forEach(function(a,o){var s=JSON.parse(n()(e));s.gatewaymac=a.value.trim(),s.publishTopic=a.value.trim(),s.subscribeTopic=a.value.trim(),s.responseTopic=a.value.trim(),t.push(s)}):a.macArr.forEach(function(a,o){var s=JSON.parse(n()(e));s.gatewaymac=a.trim(),s.publishTopic=a.trim(),s.subscribeTopic=a.trim(),s.responseTopic=a.trim(),t.push(s)}),a.$axios.post(w.a.gatewayEdit,t).then(function(t){"success"===t.data.msg?setTimeout(function(){a.$Modal.success({title:"提示！",content:t.data.data})},500):setTimeout(function(){a.$Modal.error({title:"提示！",content:t.data.data})},500)}).catch(function(a){console.log(a)})}}):this.$Message.error({title:"提示！",content:"请选择您要设置的网关mac地址"})},filterMacRegFn:function(a){if(""===a)return"";for(var t=a.split("|"),e="",o=0;o<t.length;o++)e+=t[o];return e},getDataFn:function(){var a=this;this.$Loading.start(),this.gatewayArr=[],this.$axios.get(w.a.gatewayQuery+this.$store.state.address).then(function(t){t.data.forEach(function(t,e){if("{}"!==n()(t)&&""!==t.gatewaymac){var o={value:t.gatewaymac,label:t.gatewaymac};a.gatewayArr.push(o)}}),a.$Loading.finish()}).catch(function(t){a.$Loading.error()})}},created:function(){this.getDataFn()},mounted:function(){}},y={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"gateway_setting_wrap"},[e("div",{staticClass:"row_box hover_animat custom_bg_color_white"},[e("h2",{staticClass:"row_title"},[a._v("是否应用于所有网关")]),a._v(" "),e("div",{staticClass:"form_wrap"},[e("div",{staticClass:"form_item"},[e("Row",{attrs:{gutter:20}},[e("Col",{attrs:{span:"8"}},[e("i-switch",{on:{"on-change":a.switchChangeFn},model:{value:a.setAllKey,callback:function(t){a.setAllKey=t},expression:"setAllKey"}},[e("span",{attrs:{slot:"open"},slot:"open"},[a._v("是")]),a._v(" "),e("span",{attrs:{slot:"close"},slot:"close"},[a._v("否")])])],1)],1)],1),a._v(" "),!1===a.setAllKey?e("div",{staticClass:"form_item"},[e("Row",{attrs:{gutter:20}},[e("Col",{attrs:{span:"24"}},[e("h3",[a._v("选择要应用的网关mac地址")]),a._v(" "),e("Select",{attrs:{multiple:"",filterable:""},model:{value:a.macArr,callback:function(t){a.macArr=t},expression:"macArr"}},a._l(a.gatewayArr,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1)],1)],1):a._e()])]),a._v(" "),e("div",{staticClass:"row_wrap hover_animat custom_bg_color_white"},[e("div",{staticClass:"row_box"},[e("h2",{staticClass:"row_title"},[a._v("公共配置")]),a._v(" "),e("div",{staticClass:"form_wrap"},[e("div",{staticClass:"form_item"},[e("Row",{attrs:{gutter:20}},[e("Col",{attrs:{span:"8"}},[e("h3",[a._v("是否永远关闭彩灯（默认为是）")]),a._v(" "),e("Select",{model:{value:a.configData.disableLED,callback:function(t){a.$set(a.configData,"disableLED",t)},expression:"configData.disableLED"}},a._l(a.whetherData,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1),a._v(" "),e("Col",{attrs:{span:"8"}},[e("h3",[a._v("顶部彩灯是否长亮（默认为否）")]),a._v(" "),e("Select",{model:{value:a.configData.isLongBright,callback:function(t){a.$set(a.configData,"isLongBright",t)},expression:"configData.isLongBright"}},a._l(a.whetherData,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1),a._v(" "),e("Col",{attrs:{span:"8"}},[e("h3",[a._v("是否上传 Unknown类型的数据（默认为是）")]),a._v(" "),e("Select",{model:{value:a.configData.isUploadUnkown,callback:function(t){a.$set(a.configData,"isUploadUnkown",t)},expression:"configData.isUploadUnkown"}},a._l(a.whetherData,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1)],1)],1),a._v(" "),e("div",{staticClass:"form_item"},[e("Row",{attrs:{gutter:20}},[e("Col",{attrs:{span:"8"}},[e("h3",[a._v("是否上传ibeacon类型的数据（默认为是）")]),a._v(" "),e("Select",{model:{value:a.configData.isUploadIBeacon,callback:function(t){a.$set(a.configData,"isUploadIBeacon",t)},expression:"configData.isUploadIBeacon"}},a._l(a.whetherData,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1),a._v(" "),e("Col",{attrs:{span:"8"}},[e("h3",[a._v("是否上传S1类型的数据（默认为是）")]),a._v(" "),e("Select",{model:{value:a.configData.isUploadS1,callback:function(t){a.$set(a.configData,"isUploadS1",t)},expression:"configData.isUploadS1"}},a._l(a.whetherData,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1),a._v(" "),e("Col",{attrs:{span:"8"}},[e("h3",[a._v("是否上传网关数据（默认为是）")]),a._v(" "),e("Select",{model:{value:a.configData.isUploadGateway,callback:function(t){a.$set(a.configData,"isUploadGateway",t)},expression:"configData.isUploadGateway"}},a._l(a.whetherData,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1)],1)],1),a._v(" "),e("div",{staticClass:"form_item"},[e("Row",{attrs:{gutter:20}},[e("Col",{attrs:{span:"8"}},[e("h3",[a._v("断线自动重启（默认为否）")]),a._v(" "),e("Select",{model:{value:a.configData.isauto,callback:function(t){a.$set(a.configData,"isauto",t)},expression:"configData.isauto"}},a._l(a.whetherData,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1),a._v(" "),e("Col",{attrs:{span:"8"}},[e("h3",[a._v("重启监听时间（5 ~ 65 单位秒）")]),a._v(" "),e("InputNumber",{staticStyle:{width:"100%"},attrs:{max:65,min:5,step:1,placeholder:"5 ~ 65 "},model:{value:a.configData.timeout,callback:function(t){a.$set(a.configData,"timeout",t)},expression:"configData.timeout"}})],1),a._v(" "),e("Col",{attrs:{span:"8"}},[e("h3",[a._v("过滤mac（如：AC23|C202）")]),a._v(" "),e("Input",{attrs:{placeholder:"过滤mac"},model:{value:a.configData.macReg,callback:function(t){a.$set(a.configData,"macReg",t)},expression:"configData.macReg"}})],1)],1)],1),a._v(" "),e("div",{staticClass:"form_item"},[e("Row",{attrs:{gutter:20}},[e("Col",{attrs:{span:"8"}},[e("h3",[a._v("上传服务器（如：172.20.29.2）")]),a._v(" "),e("Input",{attrs:{placeholder:"上传服务器url值"},model:{value:a.configData.mqttUrl,callback:function(t){a.$set(a.configData,"mqttUrl",t)},expression:"configData.mqttUrl"}})],1),a._v(" "),e("Col",{attrs:{span:"8"}},[e("h3",[a._v("端口")]),a._v(" "),e("Input",{attrs:{placeholder:"端口号"},model:{value:a.configData.port,callback:function(t){a.$set(a.configData,"port",t)},expression:"configData.port"}})],1)],1)],1),a._v(" "),e("div",{staticClass:"form_item"},[e("Row",{attrs:{gutter:20}},[e("Col",{attrs:{span:"8"}},[e("h3",[a._v("QoS 等级（默认值1）")]),a._v(" "),e("Select",{model:{value:a.configData.qos,callback:function(t){a.$set(a.configData,"qos",t)},expression:"configData.qos"}},a._l(a.qosData,function(t){return e("Option",{key:t.value,attrs:{value:t.value}},[a._v(a._s(t.label))])}),1)],1),a._v(" "),e("Col",{attrs:{span:"8"}},[e("h3",[a._v("提示")]),a._v(" "),e("p",{staticClass:"notice_text"},[a._v("QoS=0：最多一次，有可能重复或丢失。")]),a._v(" "),e("p",{staticClass:"notice_text"},[a._v("QoS=1：至少一次，有可能重复。")])])],1)],1)])])]),a._v(" "),e("div",{staticClass:"row_wrap"},[e("Button",{attrs:{type:"primary",shape:"circle"},on:{click:a.saveConfigFn}},[a._v("保存配置")])],1)])},staticRenderFns:[]};var C=e("VU/8")(b,y,!1,function(a){e("eI30")},"data-v-3640eac5",null);t.default=C.exports},eI30:function(a,t){}});