webpackJsonp([5],{"6d7H":function(t,a){},Medb:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("mvHQ"),i=e.n(s),o=e("bOdI"),c=e.n(o),n=e("Fd2+"),l=(e("FDxC"),e("2PSJ"),e("d9cu"),e("OeKT"),e("MHRi"),e("GKy3"),e("uTM9"),e("UEU1"),e("wvM5"),e("tLo2"),e("9ULi"),e("jydU"),e("4T1P"),e("Rv11"),e("wDsp")),r=e("TIfe"),u=(e("q29v"),e("ao6w")),h=e("eJLk"),_={name:"mobile_check_manage",components:{Button:n.b,Tag:n.y,CheckboxGroup:n.f,Checkbox:n.e,Dialog:n.k,Toast:n.z,Loading:n.o,Pagination:n.r,Field:n.l,Popup:n.t,Search:n.w,Icon:n.m,Notify:n.q,Picker:n.s},props:{},data:function(){var t;return t={inputData:[],inputDataAll:[],inputSearchValue:"",activeKey:"",showInputSearch:!1,statusColor:h.a,user:this.$store.state.user,currentPage:1,totalCount:0,hasMore:!0,checked:!0,assetsDetailData:[],deviceDetailData:[],checkedArr:[],checkAll:!1,loadingShow:!0,showPagination:!1,queryData:{assetID:"",assetName:"",memorydepart:"",memorylocDept:"",mac:"",status:""},websock:null,value:"",showSearchPane:!1},c()(t,"showSearchPane",!1),c()(t,"statusDialogShow",!1),c()(t,"statusData",u.a),t},watch:{deviceDetailData:function(){var t=this;this.deviceDetailData.forEach(function(a,e){t.assetsDetailData.forEach(function(t,e){a.Mac===t.mac&&(t.location=a.Location)})})},checkedArr:function(){this.checkedArr.length&&this.checkedArr.length===this.assetsDetailData.length?this.checkAll=!0:this.checkAll=!1}},computed:{assetsDetailDataNow:function(){return this.assetsDetailData}},methods:{certainSelectFn:function(t){"departmentroom"===this.activeKey?this.queryData.memorydepart=t:"locDept"===this.activeKey?this.queryData.memorylocDept=t:this.queryData[this.activeKey]=t,this.showInputSearch=!1,this.inputSearchValue="",this.activeKey=""},showInputSearchFn:function(t){this.showInputSearch=!0,this.activeKey=t,this.inputFocusFn(t)},handleSearchFn:function(t){this.inputData=this.inputDataAll.filter(function(a){return a.toLowerCase().indexOf(t.toLowerCase())>-1})},inputFocusFn:function(t){var a=this;this.inputDataAll=[],this.inputData=[];var e=[],s={};s[t]="1",e.push(s),this.$axios.post(l.a.inputQuery,e).then(function(e){e.data.data.forEach(function(e,s){a.inputDataAll.find(function(a){return a===e[t]})||a.inputDataAll.push(e[t])}),a.inputData=JSON.parse(i()(a.inputDataAll))}).catch(function(t){console.log(t)})},getStatusFn:function(t){this.queryData.status=t.text,this.statusDialogShow=!1},clearAssetsFn:function(){for(var t in this.queryData)this.queryData[t]=""},showMoreMenuFn:function(){this.$emit("getMessage",!0)},toCheckHistoryFn:function(){this.$router.push("/mobile/check_history")},openSearchPaneFn:function(){this.showSearchPane=!0},searchFn:function(){this.currentPage=1,this.assetsDetailData=[],this.checkedArr=[],this.checkAll=!1,this.totalCount=0,this.getDataFn(),this.showSearchPane=!1},checkAllFn:function(){!1===this.checkAll?this.$refs.checkboxGroup.toggleAll(!0):this.$refs.checkboxGroup.toggleAll(!1)},checkFn:function(){var t=this,a=[];this.checkedArr.forEach(function(e,s){t.assetsDetailData.forEach(function(t,s){e===t.assetID&&a.push(t)})}),a.length?a.length>1?n.k.confirm({title:"盘点提示！",message:"你确定要同时盘点这"+a.length+"个资产吗？"}).then(function(){t.checkCertainFn(a)}).catch(function(){}):this.checkCertainFn(a):this.$notify({type:"warning",message:"请至少选择一个资产！",duration:2e3})},checkCertainFn:function(t){var a=this,e=[];t.forEach(function(t,a){var s={assetID:t.assetID.trim()};e.push(s)});var s=this.$toast.loading({message:"盘点中...",forbidClick:!0,duration:0});this.$axios.post(l.a.assetsCheck+"checkpep="+this.user,e).then(function(t){"success"===t.data.msg?(s.clear(),a.$toast.success("盘点成功！"),a.assetsDetailData=[],a.checkedArr=[],a.checkAll=!1,a.totalCount=0,a.getDataFn()):(s.clear(),a.$toast.fail("盘点失败！"))}).catch(function(t){s.clear()})},getDataFn:function(){var t=this;this.loadingShow=!0,this.assetsDetailData=[];var a="";for(var e in this.queryData)this.queryData[e]||(this.queryData[e]=""),a+=e+"="+this.queryData[e].trim()+"&";a=a.substring(0,a.length-1),this.$axios.post(l.a.assetsQuery+"?currentPage=&"+a).then(function(a){for(var e=a.data,s=Number(e.pop().total),i=0;i<e.length;i++){for(var o in e[i])""!==e[i][o]&&"null"!==e[i][o]||(e[i][o]="--");t.assetsDetailData.push(e[i])}t.totalCount=s,t.loadingShow=!1,t.showPagination=!0}).catch(function(t){})},changePageFn:function(){this.checkedArr=[],this.checkAll=!1,this.getDataFn()},transWebsocketFn:function(t){var a=[],e=t.split("{");return e.splice(0,1),e.forEach(function(t,e){var s=t.split("}");s.splice(s.length-1,1);var i={};s[0].split(",").forEach(function(t,a){var e=t.split("=");i[e[0].trim()]=e[1]}),a.push(i)}),a},initWebSocket:function(){this.websock=new WebSocket(l.a.mapSocket+"/"+Object(r.a)()),this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onmessage=this.websocketonmessage,this.websock.onclose=this.websocketclose},websocketonmessage:function(t){var a=this.transWebsocketFn(t.data);this.deviceDetailData=a}},created:function(){},mounted:function(){this.getDataFn(),this.initWebSocket()},beforeDestroy:function(){this.websock.close()}},p={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mobile_check_manage_wrap manage_list_wrap custom_flex_column_wrap"},[e("div",{staticClass:"mobile_search_box"},[e("div",{staticClass:"mobile_search_box_left"},[e("Search",{attrs:{disabled:"",placeholder:"点击展开搜索面板",shape:"round"},on:{click:t.openSearchPaneFn},model:{value:t.value,callback:function(a){t.value=a},expression:"value"}})],1),t._v(" "),e("div",{staticClass:"mobile_search_box_right"},[e("div",{staticClass:"mobile_search_box_right_tools",staticStyle:{width:"80px"}},[e("Button",{attrs:{size:"small",round:"",type:"primary"},on:{click:t.checkFn}},[t._v("盘点")])],1),t._v(" "),e("div",{staticClass:"mobile_search_box_right_tools",staticStyle:{width:"40px"}},[e("Icon",{attrs:{name:"clock-o"},on:{click:t.toCheckHistoryFn}})],1),t._v(" "),e("div",{staticClass:"mobile_search_box_right_tools",staticStyle:{width:"40px"}},[e("Icon",{attrs:{name:"bars"},on:{click:t.showMoreMenuFn}})],1)])]),t._v(" "),e("div",{staticClass:"assets_table_wrap"},[e("div",{staticClass:"assets_table_wrap_content  clearfix"},[e("div",{staticClass:"assets_table_wrap_left"},[e("ul",{staticClass:"assets_table_ul"},[e("li",{staticClass:"assets_table_li assets_table_li_name"},[e("div",{staticClass:"assets_table_li_checkbox"},[e("Checkbox",{attrs:{shape:"square","checked-color":"#07c160"},on:{click:t.checkAllFn},model:{value:t.checkAll,callback:function(a){t.checkAll=a},expression:"checkAll"}})],1)]),t._v(" "),e("CheckboxGroup",{ref:"checkboxGroup",model:{value:t.checkedArr,callback:function(a){t.checkedArr=a},expression:"checkedArr"}},t._l(t.assetsDetailData,function(t,a){return e("li",{key:a,staticClass:"assets_table_li"},[e("div",{staticClass:"assets_table_li_checkbox"},[e("Checkbox",{attrs:{name:t.assetID,shape:"square","checked-color":"#07c160"},on:{click:function(t){t.stopPropagation()}}})],1)])}),0)],1)]),t._v(" "),e("div",{staticClass:"assets_table_wrap_right"},[e("ul",{staticClass:"assets_table_ul"},[t._m(0),t._v(" "),t._l(t.assetsDetailData,function(a,s){return e("li",{key:s,staticClass:"assets_table_li clearfix"},[e("div",{staticClass:"assets_table_item"},[e("p",[t._v(t._s(s+1))])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v(t._s(a.assetID?a.assetID:"--"))])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v(t._s(a.assetName?a.assetName:"--"))])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v(t._s(a.locDept?a.locDept:"--"))])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v(t._s(a.location?a.location:"--"))])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v(t._s(a.mac?a.mac:"--"))])]),t._v(" "),e("div",{staticClass:"assets_table_item"},["正常"===a.status?e("Tag",{attrs:{size:"medium",color:t.statusColor[0]}},[t._v(t._s(a.status))]):"待维修"===a.status?e("Tag",{attrs:{size:"medium",color:t.statusColor[1]}},[t._v(t._s(a.status))]):"维修接单"===a.status?e("Tag",{attrs:{size:"medium",color:t.statusColor[2]}},[t._v(t._s(a.status))]):"待报废"===a.status?e("Tag",{attrs:{size:"medium",color:t.statusColor[3]}},[t._v(t._s(a.status))]):"报废"===a.status?e("Tag",{attrs:{size:"medium",color:t.statusColor[4]}},[t._v(t._s(a.status))]):"外借"===a.status?e("Tag",{attrs:{size:"medium",color:t.statusColor[5]}},[t._v(t._s(a.status))]):e("Tag",{attrs:{size:"medium",color:"#f7f7f7","text-color":"#515a6e"}},[t._v(t._s(a.status))])],1),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v(t._s(a.sn?a.sn:"--"))])])])})],2)])]),t._v(" "),e("div",{staticClass:"loading_info_wrap"},[e("Pagination",{directives:[{name:"show",rawName:"v-show",value:t.showPagination&&t.assetsDetailData.length,expression:"showPagination&&assetsDetailData.length"}],attrs:{"total-items":t.totalCount,"show-page-size":2,"prev-text":"上一页","next-text":"下一页","force-ellipses":"",mode:"simple"},on:{change:t.changePageFn},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}}),t._v(" "),e("Loading",{directives:[{name:"show",rawName:"v-show",value:t.loadingShow,expression:"loadingShow"}],attrs:{size:"24px"}},[t._v("加载中...")]),t._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:!t.loadingShow&&!t.assetsDetailData.length,expression:"!loadingShow&&!assetsDetailData.length"}]},[t._v("暂无数据")])],1)]),t._v(" "),e("Popup",{attrs:{position:"top",round:""},model:{value:t.showSearchPane,callback:function(a){t.showSearchPane=a},expression:"showSearchPane"}},[e("div",{staticClass:"query_data_wrap"},[e("div",{staticClass:"query_data_box"},[e("Field",{attrs:{clearable:"",label:"资产编号",placeholder:"请输入要查询的资产编号"},model:{value:t.queryData.assetID,callback:function(a){t.$set(t.queryData,"assetID",a)},expression:"queryData.assetID"}}),t._v(" "),e("Field",{attrs:{clearable:"",label:"资产名称",center:"",placeholder:"请输入要查询的资产名称"},scopedSlots:t._u([{key:"button",fn:function(){return[e("Button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.showInputSearchFn("assetName")}}},[t._v("云数据")])]},proxy:!0}]),model:{value:t.queryData.assetName,callback:function(a){t.$set(t.queryData,"assetName",a)},expression:"queryData.assetName"}}),t._v(" "),e("Field",{attrs:{clearable:"",label:"部门名称",center:"",placeholder:"请输入要查询的部门名称"},scopedSlots:t._u([{key:"button",fn:function(){return[e("Button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.showInputSearchFn("departmentroom")}}},[t._v("云数据")])]},proxy:!0}]),model:{value:t.queryData.memorydepart,callback:function(a){t.$set(t.queryData,"memorydepart",a)},expression:"queryData.memorydepart"}}),t._v(" "),e("Field",{attrs:{clearable:"",label:"所在科室",center:"",placeholder:"请输入要查询的所在科室"},scopedSlots:t._u([{key:"button",fn:function(){return[e("Button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.showInputSearchFn("locDept")}}},[t._v("云数据")])]},proxy:!0}]),model:{value:t.queryData.memorylocDept,callback:function(a){t.$set(t.queryData,"memorylocDept",a)},expression:"queryData.memorylocDept"}}),t._v(" "),e("Field",{attrs:{disabled:"",label:"状态",placeholder:"请选择要查询的状态"},on:{click:function(a){t.statusDialogShow=!0}},model:{value:t.queryData.status,callback:function(a){t.$set(t.queryData,"status",a)},expression:"queryData.status"}})],1),t._v(" "),e("div",{staticClass:"tools_button_wrap"},[e("Button",{staticClass:"tools_button",attrs:{color:"linear-gradient(to right, #ff6034, #ee0a24)",round:""},on:{click:t.clearAssetsFn}},[t._v("清空")]),t._v(" "),e("Button",{staticClass:"tools_button",attrs:{color:"linear-gradient(to right, #69aff5, #1989fa)",round:""},on:{click:t.searchFn}},[t._v("搜索")])],1)])]),t._v(" "),e("Popup",{attrs:{position:"bottom"},model:{value:t.statusDialogShow,callback:function(a){t.statusDialogShow=a},expression:"statusDialogShow"}},[e("Picker",{attrs:{columns:t.statusData,"show-toolbar":"",title:"请选择状态","visible-item-count":5},on:{cancel:function(a){t.statusDialogShow=!1},confirm:t.getStatusFn}})],1),t._v(" "),e("Popup",{attrs:{position:"bottom"},model:{value:t.showInputSearch,callback:function(a){t.showInputSearch=a},expression:"showInputSearch"}},[e("Search",{attrs:{placeholder:"请输入搜索关键词","input-align":"center"},on:{input:t.handleSearchFn},model:{value:t.inputSearchValue,callback:function(a){t.inputSearchValue=a},expression:"inputSearchValue"}}),t._v(" "),e("Picker",{ref:"inputSelect",attrs:{"show-toolbar":"","toolbar-position":"bottom",columns:t.inputData,title:"","visible-item-count":5},on:{cancel:function(a){t.showInputSearch=!1},confirm:t.certainSelectFn}})],1)],1)},staticRenderFns:[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"assets_table_li assets_table_li_name clearfix"},[e("div",{staticClass:"assets_table_item"},[e("p",[t._v("序号")])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v("资产编号")])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v("资产名称")])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v("科室名称")])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v("存放地点")])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v("标签mac")])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v("状态")])]),t._v(" "),e("div",{staticClass:"assets_table_item"},[e("p",[t._v("SN")])])])}]};var v=e("VU/8")(_,p,!1,function(t){e("edJ8")},"data-v-79f21c32",null);a.default=v.exports},OeKT:function(t,a,e){e("XqYu")},d9cu:function(t,a,e){e("XqYu"),e("s1Ps"),e("6d7H")},edJ8:function(t,a){}});