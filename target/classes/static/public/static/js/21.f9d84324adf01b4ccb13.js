webpackJsonp([21],{"24Ov":function(e,t){},EcwQ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("wdqF"),o=a("8sRp"),i=a("KxKW"),c=a("HYs4"),s=a("NHTL"),l=a("yoLw"),r=a("EMb8"),d=a("7+uW"),u=a("xWT1"),h=a("wDsp");d.a.component("Icon",r.a),d.a.component("Table",l.a),d.a.component("Tag",s.a),d.a.component("Page",c.a),d.a.component("Button",i.a),d.a.component("Modal",o.a),d.a.component("Spin",n.a);var v={name:"account_manage",components:{},props:{},data:function(){return{tableLoading:!0,totalCount:0,pageSize:10,currentPage:1,selection:[],deleteModal:!1,achieveDelete:!1,errorDelete:!1,accountData:[],accountColumn:[{key:"account",title:"选择",type:"selection",width:100},{key:"username",title:"姓名"},{key:"phone",title:"手机号"},{key:"departmentroom",title:"部门名称"},{key:"locDept",title:"所在科室名称"},{key:"role",title:"权限",slot:"role",width:100}]}},watch:{},computed:{},methods:{checkAllGroupChange:function(e){this.selection=e},changePageFn:function(e){this.tableLoading=!0,this.currentPage=e},deleteFn:function(){var e=this;this.selection.length>0?this.$Modal.confirm({title:"删除提示",okText:"确定删除",cancelText:"取消",content:'<h2 style="color:#f94040">你确定要删除这'+this.selection.length+"个账户吗？</h2>",onOk:function(){e.deleteCertainFn()}}):this.$Message.error({content:"请至少选择一项!",duration:1})},successFn:function(){var e=this;this.achieveDelete=!0,setTimeout(function(){e.deleteModal=!1,e.currentPage=1,e.getDataFn(),setTimeout(function(){e.achieveDelete=!1,e.errorDelete=!1},500)},1e3)},errorFn:function(){var e=this;this.errorDelete=!0,setTimeout(function(){e.deleteModal=!1,setTimeout(function(){e.achieveDelete=!1,e.errorDelete=!1},500)},1e3)},deleteMySelfFn:function(){var e=this;this.achieveDelete=!0,setTimeout(function(){e.deleteModal=!1,e.currentPage=1,setTimeout(function(){e.achieveDelete=!1,e.errorDelete=!1,e.$Modal.warning({title:"提示！",content:"当前登录用户已删除，需要重新登录！",okText:"立即登录",onOk:function(){Object(u.a)()}})},500)},1e3)},deleteCertainFn:function(){var e=this;this.deleteModal=!0;for(var t=[],a=0;a<this.selection.length;a++)t.push(this.selection[a].username);this.$axios.post(h.a.accountDelete+t).then(function(t){"ok"===t.data.msg?e.successFn():"remove_myself"===t.data.msg?e.deleteMySelfFn():"failed"===t.data.msg&&e.errorFn()}).catch(function(t){e.errorFn()})},getDataFn:function(){var e=this;this.$Loading.start(),this.$axios.get(h.a.accountQuery).then(function(t){e.accountData=t.data,e.totalCount=t.data.length,e.tableLoading=!1,e.$Loading.finish()}).catch(function(e){})}},created:function(){},mounted:function(){this.getDataFn()},beforeDestroy:function(){this.$Loading.finish()}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"account_manage_wrap"},[a("div",{staticClass:"hover_animat custom_bg_color_white"},[a("div",{staticClass:"row_box"},[a("h2",{staticClass:"row_title"},[e._v("账户明细表")]),e._v(" "),a("div",{staticClass:"data_table_top clearfix"},[a("div",{staticClass:"data_table_top_left"},[a("Button",{attrs:{to:"/web/account_create",type:"primary",shape:"circle",icon:"md-add"}},[e._v("新增账户")]),e._v(" "),a("Button",{attrs:{type:"error",shape:"circle",icon:"md-trash"},on:{click:e.deleteFn}},[e._v("删除账户")])],1),e._v(" "),a("div",{staticClass:"data_table_top_right"},[a("div",{staticClass:"pagination_wrap"},[a("Page",{attrs:{"show-elevator":"","show-total":"",total:e.totalCount,current:e.currentPage,"page-size":e.pageSize},on:{"on-change":e.changePageFn}})],1)])]),e._v(" "),a("div",{staticClass:"table_scroll_wrap"},[a("Table",{staticStyle:{"min-width":"1000px"},attrs:{stripe:"",columns:e.accountColumn,data:e.accountData,size:"large",loading:e.tableLoading},on:{"on-selection-change":e.checkAllGroupChange},scopedSlots:e._u([{key:"role",fn:function(t){return["admin"===t.row.role?a("Tag",{attrs:{color:"success"}},[e._v("管理员")]):a("Tag",{attrs:{color:"warning"}},[e._v("操作员")])]}}])})],1)])]),e._v(" "),a("Modal",{attrs:{title:"","footer-hide":!0,"mask-closable":!1,closable:!1,width:"360"},model:{value:e.deleteModal,callback:function(t){e.deleteModal=t},expression:"deleteModal"}},[a("div",{staticStyle:{"text-align":"center",padding:"20px 0"}},[e.achieveDelete||e.errorDelete?e._e():a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"loding_icon",attrs:{type:"ios-loading",size:"18"}}),e._v(" "),a("div",[e._v("正在删除")])],1),e._v(" "),e.achieveDelete?a("Spin",{staticStyle:{color:"#00ad19"},attrs:{fix:""}},[a("Icon",{attrs:{type:"ios-checkmark-circle",size:"18"}}),e._v(" "),a("div",[e._v("删除成功")])],1):e._e(),e._v(" "),e.errorDelete?a("Spin",{staticStyle:{color:"#f72b2b"},attrs:{fix:""}},[a("Icon",{attrs:{type:"ios-close-circle",size:"18"}}),e._v(" "),a("div",[e._v("删除失败")])],1):e._e()],1)])],1)},staticRenderFns:[]};var g=a("VU/8")(v,f,!1,function(e){a("24Ov")},"data-v-709f8f16",null);t.default=g.exports}});