webpackJsonp([10],{"/qMM":function(t,e,a){"use strict";var s=a("9pVw");e.a=s.a},"2nDa":function(t,e,a){"use strict";var s=a("56XX"),o=a("9pVw");s.a.Group=o.a,e.a=s.a},W8W8:function(t,e){},f9DY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,o=a("bOdI"),i=a.n(o),n=a("mvHQ"),r=a.n(n),c=a("2nDa"),l=a("/qMM"),u=a("wdqF"),h=a("8sRp"),d=a("KxKW"),p=a("JtJ0"),m=a("HYs4"),v=a("X2sI"),D=a("LuSo"),f=a("9N2q"),_=a("NHTL"),g=a("yoLw"),y=a("NAz/"),w=a("a84E"),k=a("EMb8"),b=a("7+uW"),C=(a("bkN4"),a("TIfe"),a("wDsp")),N=a("Uo+3"),S=a("kitu");b.a.component("Icon",k.a),b.a.component("Row",w.a),b.a.component("Col",y.a),b.a.component("Table",g.a),b.a.component("Tag",_.a),b.a.component("DatePicker",f.a),b.a.component("Select",D.a),b.a.component("Option",v.a),b.a.component("Page",m.a),b.a.component("Input",p.a),b.a.component("Button",d.a),b.a.component("Modal",h.a),b.a.component("Spin",u.a),b.a.component("CheckboxGroup",l.a),b.a.component("Checkbox",c.a);var F={name:"assets_manage",components:{},props:{},data:function(){return{departCode:N.a,locDept:S.a,isFirstEnter:!1,chooseArr:[],queryData:{assetID:"",assetName:"",departmentroom:"",locDept:""},queryDataNow:{},chooseArrNow:[],tableLoading:!0,selection:[],totalCount:0,pageSize:10,currentPage:1,deleteModal:!1,achieveDelete:!1,errorDelete:!1,assetsDetailColumnInit:[{title:"资产id",key:"assetID",slot:"assetID"},{title:"通用名称",key:"generalName"},{title:"资产名称",key:"assetName"},{title:"规格",key:"specification"},{title:"型号",key:"type"},{title:"存放地点",key:"location"},{title:"产地",key:"placeoforigin"},{title:"品牌",key:"brand"},{title:"部门编码",key:"departmentcode"},{title:"部门名称",key:"departmentroom"},{title:"大科室编码",key:"homeofficenumber"},{title:"大科室名称",key:"homeofficename"},{title:"是否进口",key:"isentrance"},{title:"供应商名称",key:"suppliername"},{title:"生产厂商名称",key:"generatebusinessname"},{title:"所在科室名称",key:"locDept"},{title:"状态",key:"status",slot:"status",width:100}],assetsDetailColumn:[],assetsDetailData:[]}},watch:{},computed:{},methods:(s={getNowTime:function(){var t=new Date;return this.year=t.getFullYear(),this.month=t.getMonth()+1,this.date=t.getDate(),this.hour=t.getHours()<10?"0"+t.getHours():t.getHours(),this.minute=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),this.second=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds(),this.milliSeconds=t.getMilliseconds(),this.year+"-"+this.month+"-"+this.date+" "+this.hour+":"+this.minute+":"+this.second+"."+this.milliSeconds},statusFn:function(t){"正常"===t?this.$router.push("/web/device_manage"):this.$router.push("/web/damage_manage")},exportExcelFn:function(){this.$axios.get(C.a.assetsExport,{responseType:"blob"}).then(function(t){var e=t.data,a=new FileReader;a.readAsDataURL(e),a.onload=function(t){var e=document.createElement("a");e.download=name+".xls",e.href=t.target.result,document.documentElement.appendChild(e),document.documentElement.removeChild(e),e.click()}}).catch(function(t){console.log(t)})},checkAllGroupChange:function(t){this.selection=t},filterChooseFn:function(){var t=this;this.assetsDetailColumn=JSON.parse(r()(this.assetsDetailColumnInit)),this.chooseArrNow.length&&this.chooseArrNow.forEach(function(e,a){switch(e){case"标签mac":t.assetsDetailColumn.push({title:"标签mac",key:"mac"});break;case"入库时间":t.assetsDetailColumn.push({title:"入库时间",key:"buyDate"});break;case"原值":t.assetsDetailColumn.push({title:"原值",key:"money"});break;case"电量":t.assetsDetailColumn.push({title:"电量",key:"electric",slot:"electric"});default:return}})},searchAssetsFn:function(){this.queryDataNow=JSON.parse(r()(this.queryData)),this.chooseArrNow=JSON.parse(r()(this.chooseArr));var t={departmentroom:this.queryDataNow.departmentroom,locDept:this.queryDataNow.locDept,isShowMac:this.chooseArrNow.find(function(t,e){return"标签mac"===t})?"1":"0",isShowBuyDate:this.chooseArrNow.find(function(t,e){return"入库时间"===t})?"1":"0",isShowMoney:this.chooseArrNow.find(function(t,e){return"原值"===t})?"1":"0",isShowElectric:this.chooseArrNow.find(function(t,e){return"电量"===t})?"1":"0"};this.$store.commit("setQueryData",t),this.currentPage=1,this.filterChooseFn(),this.getDataFn()},clearAssetsFn:function(){for(var t in this.queryData)this.queryData[t]="";this.chooseArr=[]}},i()(s,"checkAllGroupChange",function(t){this.selection=t}),i()(s,"changePageFn",function(t){this.currentPage=t,this.getDataFn()}),i()(s,"deleteFn",function(){var t=this;if(!this.selection.length)return this.$Message.error({content:"请选择至少一项!",duration:2});this.$Modal.confirm({title:"删除提示",okText:"确定删除",cancelText:"取消",content:'<h2 style="color:#f94040">你确定要删除这'+this.selection.length+"个资产吗？</h2>",onOk:function(){t.deleteCertainFn()}})}),i()(s,"deleteCertainFn",function(){var t=this;this.deleteModal=!0;for(var e=[],a=0;a<this.selection.length;a++)e.push(this.selection[a].assetID);this.$axios.get(C.a.assetsDelete+e).then(function(e){"ok"===e.data.msg?(t.achieveDelete=!0,setTimeout(function(){t.deleteModal=!1,t.currentPage=1,t.getDataFn(),setTimeout(function(){t.achieveDelete=!1,t.errorDelete=!1},500)},1e3)):"failed"===e.data.msg&&(t.errorDelete=!0,setTimeout(function(){t.deleteModal=!1,setTimeout(function(){t.achieveDelete=!1,t.errorDelete=!1},500)},1e3))}).catch(function(e){t.errorDelete=!0,setTimeout(function(){t.deleteModal=!1,setTimeout(function(){t.achieveDelete=!1,t.errorDelete=!1},500)},1e3)})}),i()(s,"toDetailFn",function(t){for(var e=0;e<this.assetsDetailData.length;e++)if(this.assetsDetailData[e].assetID===t){var a=JSON.parse(r()(this.assetsDetailData[e]));for(var s in a)"--"!==a[s]&&"null"!==a[s]||(a[s]="");window.sessionStorage.setItem("detailData",r()(a))}this.$router.push({path:"/web/assets_detail"})}),i()(s,"getDataFn",function(){var t=this;this.tableLoading=!0,this.$Loading.start();var e="";for(var a in this.queryDataNow)this.queryDataNow[a]||(this.queryDataNow[a]=""),e+=a+"="+this.queryDataNow[a].trim()+"&";e=e+"isShowMac="+(this.chooseArrNow.find(function(t,e){return"标签mac"===t})?"1":"0")+"&isShowBuyDate="+(this.chooseArrNow.find(function(t,e){return"入库时间"===t})?"1":"0")+"&isShowMoney="+(this.chooseArrNow.find(function(t,e){return"原值"===t})?"1":"0")+"&isShowElectric="+(this.chooseArrNow.find(function(t,e){return"电量"===t})?"1":"0");var s=this.getNowTime();console.log(s),this.$axios.post(C.a.assetsQuery+"?currentPage="+this.currentPage+"&"+e).then(function(e){var a=e.data,s=a[a.length-1].timeTest;console.log(s);var o=Number(a.pop().total);t.assetsDetailData=[];for(var i=0;i<a.length;i++){for(var n in a[i])""!==a[i][n]&&"null"!==a[i][n]||(a[i][n]="--");t.assetsDetailData.push(a[i])}t.totalCount=o,t.tableLoading=!1,t.$Loading.finish()}).catch(function(e){t.$Loading.error()})}),i()(s,"getSearchConfigFn",function(){var t=JSON.parse(window.sessionStorage.getItem("queryData"));this.queryData={assetID:"",assetName:"",departmentroom:t.departmentroom?t.departmentroom:"",locDept:t.locDept?t.locDept:""},this.queryDataNow=JSON.parse(r()(this.queryData)),"1"===t.isShowMac&&this.chooseArr.push("标签mac"),"1"===t.isShowBuyDate&&this.chooseArr.push("入库时间"),"1"===t.isShowMoney&&this.chooseArr.push("原值"),"1"===t.isShowElectric&&this.chooseArr.push("电量"),this.chooseArrNow=JSON.parse(r()(this.chooseArr)),this.filterChooseFn(),this.getDataFn()}),i()(s,"authorityFn",function(){"admin"===this.$store.state.role&&(this.assetsDetailColumnInit.find(function(t,e){return"选择"===t.title})||this.assetsDetailColumnInit.unshift({title:"选择",slot:"selection",type:"selection",width:80}))}),i()(s,"initAllDataFn",function(){this.chooseArr=[],this.queryData={assetID:"",assetName:"",departmentroom:"",locDept:""},this.queryDataNow={},this.tableLoading=!0,this.selection=[],this.totalCount=0,this.pageSize=10,this.currentPage=1,this.deleteModal=!1,this.achieveDelete=!1,this.errorDelete=!1,this.assetsDetailColumn=[],this.assetsDetailData=[],this.authorityFn(),this.assetsDetailColumn=JSON.parse(r()(this.assetsDetailColumnInit))}),s),beforeRouteEnter:function(t,e,a){"assets_detail"==e.name&&(e.meta.needFresh?t.meta.isBack=!1:t.meta.isBack=!0),a()},created:function(){this.isFirstEnter=!0},mounted:function(){},activated:function(){this.$route.meta.isBack&&!this.isFirstEnter||(this.initAllDataFn(),this.getSearchConfigFn()),this.$route.meta.isBack=!1,this.isFirstEnter=!1},deactivated:function(){this.$Loading.finish()}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"assets_manage_wrap"},[a("div",{staticClass:"hover_animat custom_bg_color_white"},[a("div",{staticClass:"row_box"},[a("h2",{staticClass:"row_title"},[t._v("按条件筛选")]),t._v(" "),a("div",{staticClass:"form_wrap"},[a("div",{staticClass:"form_item"},[a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:"6"}},[a("h3",[t._v("资产id")]),t._v(" "),a("Input",{attrs:{placeholder:"资产id"},model:{value:t.queryData.assetID,callback:function(e){t.$set(t.queryData,"assetID",e)},expression:"queryData.assetID"}})],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("h3",[t._v("资产名称")]),t._v(" "),a("Input",{attrs:{placeholder:"资产名称"},model:{value:t.queryData.assetName,callback:function(e){t.$set(t.queryData,"assetName",e)},expression:"queryData.assetName"}})],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("h3",[t._v("部门名称")]),t._v(" "),a("Select",{attrs:{clearable:""},model:{value:t.queryData.departmentroom,callback:function(e){t.$set(t.queryData,"departmentroom",e)},expression:"queryData.departmentroom"}},t._l(t.departCode,function(e){return a("Option",{key:e.value,attrs:{value:e.name}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("h3",[t._v("所在科室名称")]),t._v(" "),a("Select",{attrs:{clearable:""},model:{value:t.queryData.locDept,callback:function(e){t.$set(t.queryData,"locDept",e)},expression:"queryData.locDept"}},t._l(t.locDept,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1)],1)],1),t._v(" "),a("div",{staticClass:"form_item"},[a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:"12"}},[a("h3",[t._v("可选择显示项目")]),t._v(" "),a("CheckboxGroup",{model:{value:t.chooseArr,callback:function(e){t.chooseArr=e},expression:"chooseArr"}},[a("Checkbox",{attrs:{label:"标签mac"}}),t._v(" "),a("Checkbox",{attrs:{label:"入库时间"}}),t._v(" "),a("Checkbox",{attrs:{label:"原值"}}),t._v(" "),a("Checkbox",{attrs:{label:"电量"}})],1)],1)],1)],1)]),t._v(" "),a("div",{staticClass:"submit_btn_wrap"},[a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.searchAssetsFn}},[t._v("搜索")]),t._v(" "),a("Button",{attrs:{type:"error",shape:"circle"},on:{click:t.clearAssetsFn}},[t._v("清空")])],1)])]),t._v(" "),a("div",{staticClass:"row_wrap hover_animat custom_bg_color_white"},[a("div",{staticClass:"row_box"},[a("h2",{staticClass:"row_title"},[t._v("资产明细表")]),t._v(" "),a("div",{staticClass:"data_table_top clearfix"},[a("div",{staticClass:"data_table_top_left"},[a("Button",{attrs:{to:"/web/assets_create",shape:"circle",type:"primary",icon:"md-add"}},[t._v("新增资产")]),t._v(" "),"admin"===t.$store.state.role?a("Button",{attrs:{shape:"circle",type:"error",icon:"md-trash"},on:{click:t.deleteFn}},[t._v("删除资产")]):t._e(),t._v(" "),a("Button",{attrs:{shape:"circle",type:"success",icon:"md-archive"},on:{click:t.exportExcelFn}},[t._v("导出资产总表")])],1),t._v(" "),a("div",{staticClass:"data_table_top_right"},[a("div",{staticClass:"pagination_wrap"},[a("Page",{attrs:{"show-elevator":"","show-total":"",total:t.totalCount,current:t.currentPage,"page-size":t.pageSize},on:{"on-change":t.changePageFn}})],1)])]),t._v(" "),a("div",{staticClass:"table_scroll_wrap"},[a("Table",{staticStyle:{"min-width":"1500px"},attrs:{stripe:"",columns:t.assetsDetailColumn,data:t.assetsDetailData,size:"large",loading:t.tableLoading},on:{"on-selection-change":t.checkAllGroupChange},scopedSlots:t._u([{key:"assetID",fn:function(e){var s=e.row;return[a("a",{on:{click:function(e){return t.toDetailFn(s.assetID)}}},[t._v(t._s(s.assetID))])]}},{key:"electric",fn:function(e){var s=e.row;return[a("span",[t._v(t._s(s.electric)+"%")])]}},{key:"status",fn:function(e){var s=e.row;return["正常"===s.status?a("Tag",{attrs:{color:"success"}},[a("span",{on:{click:function(e){return t.statusFn(s.status)}}},[t._v(t._s(s.status))])]):"在修"===s.status?a("Tag",{attrs:{color:"warning"}},[a("span",{on:{click:function(e){return t.statusFn(s.status)}}},[t._v(t._s(s.status))])]):"已报废"===s.status?a("Tag",{attrs:{color:"error"}},[a("span",{on:{click:function(e){return t.statusFn(s.status)}}},[t._v(t._s(s.status))])]):(s.status,a("Tag",{attrs:{color:"default"}},[a("span",[t._v(t._s(s.status))])]))]}}])})],1)])]),t._v(" "),a("Modal",{attrs:{title:"","footer-hide":!0,"mask-closable":!1,closable:!1,width:"360"},model:{value:t.deleteModal,callback:function(e){t.deleteModal=e},expression:"deleteModal"}},[a("div",{staticStyle:{"text-align":"center",padding:"20px 0"}},[t.achieveDelete||t.errorDelete?t._e():a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"loding_icon",attrs:{type:"ios-loading",size:"18"}}),t._v(" "),a("div",[t._v("正在删除")])],1),t._v(" "),t.achieveDelete?a("Spin",{staticStyle:{color:"#00ad19"},attrs:{fix:""}},[a("Icon",{attrs:{type:"ios-checkmark-circle",size:"18"}}),t._v(" "),a("div",[t._v("删除成功")])],1):t._e(),t._v(" "),t.errorDelete?a("Spin",{staticStyle:{color:"#f72b2b"},attrs:{fix:""}},[a("Icon",{attrs:{type:"ios-close-circle",size:"18"}}),t._v(" "),a("div",[t._v("删除失败")])],1):t._e()],1)])],1)},staticRenderFns:[]};var x=a("VU/8")(F,A,!1,function(t){a("W8W8")},"data-v-69f87b3a",null);e.default=x.exports}});